{"__requires":[{"type":"grafana","id":"grafana","name":"Grafana","version":"5.3.0"},{"type":"panel","id":"graph","name":"Graph","version":"5.0.0"},{"type":"datasource","id":"prometheus","name":"Prometheus","version":"5.0.0"},{"type":"panel","id":"singlestat","name":"Singlestat","version":"5.0.0"},{"type":"panel","id":"table","name":"Table","version":"5.0.0"}],"annotations":{"list":[{"builtIn":1,"datasource":"-- Grafana --","enable":true,"hide":true,"iconColor":"rgba(0, 211, 255, 1)","name":"Annotations & Alerts","type":"dashboard"}]},"description":"Metrics useful for Prometheus itself.","editable":true,"gnetId":9761,"graphTooltip":0,"id":null,"iteration":1553855511042,"links":[],"panels":[{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":0},"id":49,"panels":[],"title":"Basics","type":"row"},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","decimals":2,"editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":1},"id":9,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"irate(process_cpu_seconds_total{job=\"$job\", namespace=\"$namespace\"}[1m])","format":"time_series","hide":false,"intervalFactor":2,"legendFormat":"1m","metric":"prometheus_local_storage_ingested_samples_total","refId":"A","step":10},{"expr":"irate(process_cpu_seconds_total{job=\"$job\", namespace=\"$namespace\"}[5m])","format":"time_series","hide":false,"intervalFactor":2,"legendFormat":"5m","metric":"prometheus_local_storage_ingested_samples_total","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"CPU","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":["avg"]},"yaxes":[{"format":"percentunit","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Allocated bytes":"#7EB26D","Allocated bytes - 1m max":"#BF1B00","Allocated bytes - 1m min":"#BF1B00","Allocated bytes - 5m max":"#BF1B00","Allocated bytes - 5m min":"#BF1B00","Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833","RSS":"#447EBC"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","decimals":null,"editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":8,"y":1},"id":6,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/-/","fill":0}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"process_virtual_memory_bytes{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Virtual","metric":"process_resident_memory_bytes","refId":"A","step":10},{"expr":"process_resident_memory_bytes{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Resident","metric":"go_memstats_alloc_bytes","refId":"B","step":10},{"expr":"go_memstats_alloc_bytes{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Allocated","metric":"go_memstats_next_gc_bytes","refId":"C","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Memory","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","decimals":2,"editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":1},"id":71,"legend":{"alignAsTable":false,"avg":false,"current":false,"hideEmpty":false,"max":false,"min":false,"rightSide":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_storage_blocks_bytes_total{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Used","metric":"prometheus_local_storage_ingested_samples_total","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Disk","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":["avg"]},"yaxes":[{"format":"bytes","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","description":"","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":8},"id":38,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(0.9, sum(rate(prometheus_http_request_duration_seconds_bucket{handler=~\"/api/.*|/-/.*|/metrics\", job=\"$job\", namespace=\"$namespace\"}[5m])) by (handler, le))","format":"time_series","intervalFactor":1,"legendFormat":"{{handler}}","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"HTTP Request Latency","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","description":"","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":8,"y":8},"id":37,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"histogram_quantile(0.9, sum(rate(prometheus_http_response_size_bytes_bucket{handler=~\"/api/.*|/-/.*|/metrics\", job=\"$job\", namespace=\"$namespace\"}[5m])) by (handler, le))","format":"time_series","intervalFactor":2,"legendFormat":"{{handler}}","metric":"prometheus_local_storage_memory_chunkdescs","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"HTTP Response Size","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"decbytes","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Max":"#e5ac0e","Open":"#508642"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":8},"id":41,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"process_open_fds{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":1,"legendFormat":"Open","refId":"A"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"File Descriptors","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":false,"gridPos":{"h":1,"w":24,"x":0,"y":15},"id":46,"panels":[],"title":"Ingestion","type":"row"},{"aliasColors":{"samples/s":"#e5a8e2"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":16},"id":1,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(prometheus_tsdb_head_samples_appended_total{job=\"$job\", namespace=\"$namespace\"}[5m])","format":"time_series","intervalFactor":2,"legendFormat":"Ingested","metric":"prometheus_local_storage_ingested_samples_total","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Samples Appended","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"ops","label":"","logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833","Time series":"#70dbed"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":8,"y":16},"id":3,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_head_series{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Total","metric":"prometheus_local_storage_memory_series","refId":"A","step":10},{"expr":"increase(prometheus_tsdb_head_series_created_total{job=\"$job\", namespace=\"$namespace\"}[1m])","format":"time_series","intervalFactor":1,"legendFormat":"Created","refId":"B"},{"expr":"increase(prometheus_tsdb_head_series_removed_total{job=\"$job\", namespace=\"$namespace\"}[1m])","format":"time_series","intervalFactor":1,"legendFormat":"Removed","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Series","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833","To persist":"#9AC48A"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":16},"id":2,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"/Max.*/","fill":0}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_head_chunks{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Total","metric":"prometheus_local_storage_memory_chunks","refId":"A","step":10},{"expr":"round(increase(prometheus_tsdb_head_chunks_created_total{job=\"$job\", namespace=\"$namespace\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"Created","refId":"B"},{"expr":"round(increase(prometheus_tsdb_head_chunks_removed_total{job=\"$job\", namespace=\"$namespace\"}[1m]))","format":"time_series","intervalFactor":1,"legendFormat":"Removed","refId":"C"}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Chunks","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":23},"id":52,"panels":[{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max":"#447ebc","Max chunks":"#052B51","Max to persist":"#3F6833","Min":"#447ebc","Now":"#7eb26d"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":0,"gridPos":{"h":7,"w":8,"x":0,"y":24},"id":28,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"Max","fillBelowTo":"Min","lines":false}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_head_min_time{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","hide":false,"intervalFactor":2,"legendFormat":"Min","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10},{"expr":"time() * 1000","format":"time_series","hide":false,"intervalFactor":2,"legendFormat":"Now","refId":"C"},{"expr":"prometheus_tsdb_head_max_time{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","hide":false,"intervalFactor":2,"legendFormat":"Max","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Head Time Range","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"dateTimeAsIso","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Failed Compactions":"#bf1b00","Failed Reloads":"#bf1b00","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":0,"gridPos":{"h":7,"w":8,"x":8,"y":24},"id":30,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(increase(prometheus_tsdb_reloads_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Reloads","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"TSDB Reloads","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":24},"id":27,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(histogram_quantile(0.90, sum(increase(prometheus_tsdb_compaction_chunk_range_seconds_bucket{job=\"$job\", namespace=\"$namespace\"}[10m])) by (le)))","format":"time_series","intervalFactor":2,"legendFormat":"Avg Chunk Time Range","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"First Compaction, Avg Chunk Time Range","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"s","label":"","logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":31},"id":29,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_head_gc_duration_seconds{job=\"$job\", namespace=\"$namespace\", quantile!=\"0.01\", quantile!=\"0.05\"}","format":"time_series","intervalFactor":2,"legendFormat":"{{quantile}}","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Head GC Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Failed Compactions":"#bf1b00","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":0,"gridPos":{"h":7,"w":8,"x":8,"y":31},"id":19,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(increase(prometheus_tsdb_compactions_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Compactions","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"TSDB Compactions","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"none","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":31},"id":34,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(histogram_quantile(0.90, sum(increase(prometheus_tsdb_compaction_chunk_samples_bucket{job=\"$job\", namespace=\"$namespace\"}[10m])) by (le)))","format":"time_series","intervalFactor":2,"legendFormat":"Chunk Samples","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"First Compaction, Avg Chunk Samples","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"none","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":38},"id":33,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"rate(prometheus_tsdb_compaction_duration_seconds_sum{job=\"$job\", namespace=\"$namespace\"}[10m]) / rate(prometheus_tsdb_compaction_duration_seconds_count{job=\"$job\", namespace=\"$namespace\"}[10m])","format":"time_series","intervalFactor":2,"legendFormat":"Duration","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Compaction Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Allocated bytes":"#F9BA8F","Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833","RSS":"#890F02"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":0,"gridPos":{"h":7,"w":8,"x":8,"y":38},"id":8,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(increase(prometheus_tsdb_time_retentions_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","intervalFactor":2,"legendFormat":"Time Cutoffs","metric":"last","refId":"A","step":10},{"expr":"round(increase(prometheus_tsdb_size_retentions_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","intervalFactor":2,"legendFormat":"Size Cutoffs","metric":"last","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"TSDB Retention Cutoffs","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"none","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":38},"id":35,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(histogram_quantile(0.90, sum(rate(prometheus_tsdb_compaction_chunk_size_bytes_bucket{job=\"$job\", namespace=\"$namespace\"}[10m])) by (le)))","format":"time_series","intervalFactor":2,"legendFormat":"Bytes/Sample","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"First Compaction, Avg Bytes/Sample","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":null,"format":"bytes","label":null,"logBase":1,"max":null,"min":null,"show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Failed Compactions":"#bf1b00","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":45},"id":31,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_wal_fsync_duration_seconds{job=\"$job\", namespace=\"$namespace\", quantile!=\"0.01\", quantile!=\"0.05\"}","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Fsync ({{quantile}})","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10},{"expr":"prometheus_tsdb_wal_truncate_duration_seconds{job=\"$job\", namespace=\"$namespace\", quantile!=\"0.99\", quantile!=\"0.05\"}","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Truncate ({{quantile}})","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"B","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"WAL Fsync&Truncate Latency","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Failed Compactions":"#bf1b00","Max chunks":"#052B51","Max to persist":"#3F6833","{instance=\"demo.robustperception.io:9090\",job=\"prometheus\"}":"#bf1b00"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":8,"y":45},"id":32,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(increase(prometheus_tsdb_wal_corruptions_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"WAL Corruptions","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"A","step":10},{"expr":"round(increase(prometheus_tsdb_reloads_failures_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Reload Failures","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"B","step":10},{"expr":"round(increase(prometheus_tsdb_head_series_not_found_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Head Series Not Found","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"C","step":10},{"expr":"round(increase(prometheus_tsdb_compactions_failed_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Compaction Failures","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"D","step":10},{"expr":"round(increase(prometheus_tsdb_retention_cutoffs_failures_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"Retention Cutoff Failures","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"E","step":10},{"expr":"round(increase(prometheus_tsdb_checkpoint_creations_failed_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"WAL Checkpoint Creation Failures","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"F","step":10},{"expr":"round(increase(prometheus_tsdb_checkpoint_deletions_failed_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","interval":"","intervalFactor":2,"legendFormat":"WAL Checkpoint Deletion Failures","metric":"prometheus_local_storage_series_chunks_persisted_count","refId":"G","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"TSDB Problems","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"none","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":45},"id":14,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[{"alias":"Queue length","yaxis":2}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_tsdb_blocks_loaded{job=\"$job\", namespace=\"$namespace\"}","format":"time_series","intervalFactor":2,"legendFormat":"Blocks Loaded","metric":"prometheus_local_storage_indexing_batch_sizes_sum","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Blocks Loaded","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true}],"yaxis":{"align":false,"alignLevel":null}}],"title":"Compaction","type":"row"},{"collapsed":true,"gridPos":{"h":1,"w":24,"x":0,"y":24},"id":63,"panels":[{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","description":"Time spent in each mode, per second","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":0,"y":25},"id":24,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":true,"steppedLine":false,"targets":[{"expr":"rate(prometheus_engine_query_duration_seconds_sum{job=\"$job\", namespace=\"$namespace\"}[1m])","format":"time_series","intervalFactor":2,"legendFormat":"{{slice}}","metric":"prometheus_local_storage_memory_chunkdescs","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Query Engine","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":8,"y":25},"id":23,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null as zero","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"prometheus_rule_group_duration_seconds{job=\"$job\", namespace=\"$namespace\", quantile!=\"0.01\", quantile!=\"0.05\"}","format":"time_series","intervalFactor":2,"legendFormat":"{{quantile}}","metric":"prometheus_local_storage_memory_chunkdescs","refId":"A","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rule Group Evaluation Time","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"format":"s","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}},{"aliasColors":{"Chunks":"#1F78C1","Chunks to persist":"#508642","Max chunks":"#052B51","Max to persist":"#3F6833"},"bars":false,"dashLength":10,"dashes":false,"datasource":"RANCHER_MONITORING","editable":true,"error":false,"fill":1,"gridPos":{"h":7,"w":8,"x":16,"y":25},"id":22,"legend":{"avg":false,"current":false,"max":false,"min":false,"show":true,"total":false,"values":false},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","percentage":false,"pointradius":5,"points":false,"renderer":"flot","seriesOverrides":[],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[{"expr":"round(increase(prometheus_rule_group_iterations_missed_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","intervalFactor":2,"legendFormat":"Missed","metric":"prometheus_local_storage_memory_chunkdescs","refId":"B","step":10},{"expr":"round(increase(prometheus_rule_evaluation_failures_total{job=\"$job\", namespace=\"$namespace\"}[10m]))","format":"time_series","intervalFactor":2,"legendFormat":"Failed","metric":"prometheus_local_storage_memory_chunkdescs","refId":"C","step":10}],"thresholds":[],"timeFrom":null,"timeRegions":[],"timeShift":null,"title":"Rule Group Evaluation Problem","tooltip":{"msResolution":false,"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"buckets":null,"mode":"time","name":null,"show":true,"values":[]},"yaxes":[{"decimals":0,"format":"short","label":null,"logBase":1,"max":null,"min":"0","show":true},{"format":"short","label":null,"logBase":1,"max":null,"min":null,"show":true}],"yaxis":{"align":false,"alignLevel":null}}],"title":"Query Engine","type":"row"}],"refresh":"1m","schemaVersion":16,"style":"dark","tags":[],"templating":{"list":[{"allValue":null,"current":{"text":"$job","value":"$job"},"datasource":"RANCHER_MONITORING","definition":"query_result(prometheus_tsdb_head_samples_appended_total)","hide":2,"includeAll":false,"label":null,"multi":false,"name":"job","options":[],"query":"query_result(prometheus_tsdb_head_samples_appended_total)","refresh":2,"regex":"/.*job=\"([^\"]+)/","skipUrlSync":false,"sort":1,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false},{"allValue":null,"current":{"text":"cattle-prometheus","value":"cattle-prometheus"},"datasource":"RANCHER_MONITORING","definition":"query_result(up{job=~\"$job\"})","hide":0,"includeAll":false,"label":"Namespace","multi":false,"name":"namespace","options":[],"query":"query_result(up{job=~\"$job\"})","refresh":2,"regex":"/.*namespace=\"([^\"]+).*/","skipUrlSync":false,"sort":0,"tagValuesQuery":"","tags":[],"tagsQuery":"","type":"query","useTags":false}]},"time":{"from":"now-5m","to":"now"},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"browser","title":"Prometheus Stats","uid":"4hEg-4eiz","version":1}